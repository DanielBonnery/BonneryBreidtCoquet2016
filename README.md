# Asymptotics for the maximum sample likelihood estimator under informative selection from a finite population

`pubBonneryBreidtCoquet2016` is a R package that contains the source code to reproduce the simulations of ["Asymptotics for the maximum sample likelihood estimator under informative selection from a finite population"](http://www.e-publications.org/ims/submission/BEJ/user/submissionFile/23537?confirm=3b2ff5b3) by Bonnery, Breidt and Coquet

NB: no seed was used for table 1 and 2 in the paper, so results differ slightly.

## Execution

```r
devtools::install_github("DanielBonnery/pubBonneryBreidtCoquet2016")
library(pubBonneryBreidtCoquet2016)
demo(table1)
demo(table2)
demo(table3)
```

##Output



                                                                                                
### Table 1


|Estimator |$\theta$ |$\xi$ |Conditional to (N,sampleparam.tauh1,sampleparam.tauh2) |Mean |% Relative Bias |RMSE Ratio |Empirical Variance |Asymptotic Variance |
|:---------|:--------|:-----|:------------------------------------------------------|:----|:---------------|:----------|:------------------|:-------------------|
|Naive     |4        |0.1   |1e+04, 1e-02, 1e-01                                    |4.1  |2.39            |1.35043    |0.0181758          |NA                  |
|Pseudo    |4        |0.1   |1e+04, 1e-02, 1e-01                                    |4.01 |0.311           |1.53996    |0.0309899          |NA                  |
|Sample    |4        |0.1   |1e+04, 1e-02, 1e-01                                    |4.01 |0.143           |1          |0.0201916          |0.0200028           |
|Full      |4        |0.1   |1e+04, 1e-02, 1e-01                                    |NaN  |NaN             |NA         |NA                 |NA                  |



|Estimator |$\theta$ |$\xi$ |Conditional to (N,sampleparam.tauh1,sampleparam.tauh2) |Mean |% Relative Bias |RMSE Ratio |Empirical Variance |Asymptotic Variance |
|:---------|:--------|:-----|:------------------------------------------------------|:----|:---------------|:----------|:------------------|:-------------------|
|Naive     |4        |1     |1e+04, 1e-02, 1e-01                                    |4.86 |21.5            |15.3729    |0.031139           |NA                  |
|Pseudo    |4        |1     |1e+04, 1e-02, 1e-01                                    |4.05 |1.19            |2.13148    |0.104135           |NA                  |
|Sample    |4        |1     |1e+04, 1e-02, 1e-01                                    |4.02 |0.416           |1          |0.0496496          |0.0509886           |
|Full      |4        |1     |1e+04, 1e-02, 1e-01                                    |NaN  |NaN             |NA         |NA                 |NA                  |



|Estimator |$\theta$ |$\xi$ |Conditional to (N,sampleparam.tauh1,sampleparam.tauh2) |Mean |% Relative Bias |RMSE Ratio |Empirical Variance |Asymptotic Variance |
|:---------|:--------|:-----|:------------------------------------------------------|:----|:---------------|:----------|:------------------|:-------------------|
|Naive     |4        |2     |1e+04, 1e-02, 1e-01                                    |5.59 |39.7            |33.8249    |0.0567029          |NA                  |
|Pseudo    |4        |2     |1e+04, 1e-02, 1e-01                                    |4.06 |1.4             |1.87451    |0.139452           |NA                  |
|Sample    |4        |2     |1e+04, 1e-02, 1e-01                                    |4.02 |0.419           |1          |0.0757842          |0.0771277           |
|Full      |4        |2     |1e+04, 1e-02, 1e-01                                    |NaN  |NaN             |NA         |NA                 |NA                  |

### Table 2


|Estimator |$\theta$      |$\xi$ |Conditional to (N,sigma,EX,SX,sampleparam.proph1,sampleparam.proph2,sampleparam.tauh1,sampleparam.tauh2)       |Mean                |% Relative Bias      |RMSE Ratio                      |Empirical Variance                 |Asymptotic Variance                |
|:---------|:-------------|:-----|:--------------------------------------------------------------------------------------------------------------|:-------------------|:--------------------|:-------------------------------|:----------------------------------|:----------------------------------|
|Naive     |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e-01, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |2.270, 0.788, 1.770 |354.0, -21.2, -11.4  |1.000000, 1.000000, 0.949222    |0.03503440, 0.01488560, 0.00829343 |NA                                 |
|Pseudo    |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e-01, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |0.506, 1.010, 1.980 |1.110, 0.764, -1.150 |0.0218302, 0.5959420, 0.2771730 |0.0692524, 0.0355714, 0.0170555    |NA                                 |
|Sample    |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e-01, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |2.270, 0.788, 1.770 |354.0, -21.2, -11.7  |1, 1, 1                         |0.03503430, 0.01488560, 0.00822708 |0.03207760, 0.01771640, 0.00892672 |
|Full      |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e-01, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |NaN, NaN, NaN       |NaN, NaN, NaN        |NA, NA, NA                      |NA, NA, NA                         |NA                                 |



|Estimator |$\theta$      |$\xi$ |Conditional to (N,sigma,EX,SX,sampleparam.proph1,sampleparam.proph2,sampleparam.tauh1,sampleparam.tauh2)       |Mean                |% Relative Bias          |RMSE Ratio                      |Empirical Variance                 |Asymptotic Variance             |
|:---------|:-------------|:-----|:--------------------------------------------------------------------------------------------------------------|:-------------------|:------------------------|:-------------------------------|:----------------------------------|:-------------------------------|
|Naive     |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e+00, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |2.22, 0.80, 1.78    |344.0, -20.0, -10.8      |1.000000, 1.000000, 0.946413    |0.03629040, 0.01526960, 0.00786459 |NA                              |
|Pseudo    |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e+00, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |0.509, 1.000, 1.980 |1.7900, -0.0283, -1.0800 |0.0241624, 0.6473600, 0.2935950 |0.0722261, 0.0359059, 0.0163376    |NA                              |
|Sample    |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e+00, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |2.22, 0.80, 1.78    |344.0, -20.0, -11.1      |1, 1, 1                         |0.03629030, 0.01526950, 0.00780168 |0.0421493, 0.0177310, 0.0113943 |
|Full      |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e+00, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |NaN, NaN, NaN       |NaN, NaN, NaN            |NA, NA, NA                      |NA, NA, NA                         |NA                              |



|Estimator |$\theta$      |$\xi$ |Conditional to (N,sigma,EX,SX,sampleparam.proph1,sampleparam.proph2,sampleparam.tauh1,sampleparam.tauh2)       |Mean                |% Relative Bias      |RMSE Ratio                   |Empirical Variance                 |Asymptotic Variance                |
|:---------|:-------------|:-----|:--------------------------------------------------------------------------------------------------------------|:-------------------|:--------------------|:----------------------------|:----------------------------------|:----------------------------------|
|Naive     |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e+01, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |1.140, 0.967, 1.960 |129.00, -3.28, -1.84 |0.999998, 1.000000, 0.939560 |0.03690170, 0.01580060, 0.00764552 |NA                                 |
|Pseudo    |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e+01, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |0.506, 0.998, 1.970 |1.24, -0.23, -1.32   |0.192368, 2.369780, 2.048620 |0.0866027, 0.0399814, 0.0189159    |NA                                 |
|Sample    |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e+01, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |1.140, 0.967, 1.960 |129.00, -3.28, -2.23 |1, 1, 1                      |0.03690150, 0.01580050, 0.00758437 |0.05181540, 0.01628270, 0.00887132 |
|Full      |0.5, 1.0, 2.0 |2     |5.000000e+03, 1.000000e+01, 1.000000e+00, 1.000000e+00, 7.000000e-01, 3.000000e-01, 1.428571e-02, 1.333333e-01 |NaN, NaN, NaN       |NaN, NaN, NaN        |NA, NA, NA                   |NA, NA, NA                         |NA                                 |


### Table 3


|Selection    |Estimator |Mean   |% Relative Bias |RMSE Ratio |Empirical Variance |Average Estimated Variance |Variance Ratio |
|:------------|:---------|:------|:---------------|:----------|:------------------|:--------------------------|:--------------|
|Unstratified |Naive     |36.949 |-7.286          |20.995     |0.188              |0.186                      |0.989          |
|Unstratified |Pseudo    |39.805 |-0.122          |1.106      |0.452              |0.419                      |0.926          |
|Unstratified |Sample    |39.827 |-0.065          |1          |0.41               |0.388                      |0.945          |
|Stratified   |Naive     |36.932 |-7.328          |113.911    |0.006              |0.188                      |30.271         |
|Stratified   |Pseudo    |39.858 |0.013           |2.448      |0.184              |0.169                      |0.923          |
|Stratified   |Sample    |39.848 |-0.012          |1          |0.075              |0.066                      |0.886          |
